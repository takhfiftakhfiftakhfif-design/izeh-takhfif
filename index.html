<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ®ÙÛŒÙØ§Øª Ø§ÛŒØ°Ù‡ | Ù‡ÙˆØ´Ù…Ù†Ø¯</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <style>
        :root { --main: #ff3e3e; --bg: #f7f7f7; --yellow-box: rgba(255, 253, 208, 0.98); }
        body { font-family: Tahoma, sans-serif; background: var(--bg); margin: 0; padding-bottom: 110px; overflow-x: hidden; -webkit-tap-highlight-color: transparent; user-select: none; }

        /* Ù‡Ø¯Ø± Ùˆ Ù†Ù…Ø§Ø¯ ØªØ®ÙÛŒÙ */
        .top-nav { text-align: center; background: #fff; padding: 25px 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .discount-logo { 
            width: 70px; height: 70px; background: var(--main); border-radius: 50%; 
            margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; 
            color: white; font-weight: 900; position: relative; border: 4px solid #fff; box-shadow: 0 4px 15px rgba(255,62,62,0.4);
        }
        .discount-logo span { font-size: 24px; position: relative; }
        .discount-logo::after { 
            content: ''; position: absolute; width: 45px; height: 3px; background: #fff; 
            transform: rotate(-45deg); opacity: 0.9; 
        }

        .search-mini { width: 85%; padding: 12px; border-radius: 25px; border: 1.5px solid #ddd; outline: none; margin-top: 15px; text-align: center; }

        /* Ù†ÙˆØ§Ø± Ù…ØªØ­Ø±Ú© */
        .marquee-container { background: #000; color: #fff; padding: 10px 0; overflow: hidden; border-bottom: 2px solid var(--main); }
        .marquee-content { display: inline-block; white-space: nowrap; animation: marquee-scroll 25s linear infinite; font-weight: bold; }
        @keyframes marquee-scroll { from { transform: translateX(-100%); } to { transform: translateX(100vw); } }

        /* Ø§Ø³ØªÙˆØ±ÛŒ Ø¨Ø§Ø± */
        .story-bar { display: flex; gap: 15px; padding: 20px; background: #fff; overflow-x: auto; scrollbar-width: none; }
        .story-bar::-webkit-scrollbar { display: none; }
        .story-circle { min-width: 75px; text-align: center; cursor: pointer; }
        .story-circle img { width: 66px; height: 66px; border-radius: 50%; border: 3px solid var(--main); padding: 2px; object-fit: cover; }

        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .card-container { background: #fff; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.08); cursor: pointer; height: 180px; position: relative; }
        .card-container img { width: 100%; height: 130px; object-fit: cover; }
        .card-name { padding: 8px; text-align: center; font-weight: bold; font-size: 12px; }

        /* Ø¯Ú©Ù…Ù‡ ØªØ¨Ù„ÛŒØºØ§Øª */
        .biz-float-btn { position: fixed; bottom: 15px; left: 10px; right: 10px; background: linear-gradient(45deg, #111, #444); color: #fff; padding: 15px; border-radius: 18px; z-index: 1000; border: 2.5px solid #ffd700; cursor: pointer; font-size: 11px; text-align: center; font-weight: bold; box-shadow: 0 5px 20px rgba(0,0,0,0.4); }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø§ØµÙ„ÛŒ */
        #storyModal, #bizModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 99999; color: #fff; }
        #bizModal { background: rgba(0,0,0,0.96); backdrop-filter: blur(15px); overflow-y: auto; padding: 20px; box-sizing: border-box; }

        .prog-container { position: absolute; top: 10px; left: 10px; right: 10px; display: flex; gap: 4px; z-index: 10001; }
        .p-bar { flex: 1; height: 3px; background: rgba(255,255,255,0.3); border-radius: 2px; overflow: hidden; }
        .p-fill { height: 100%; background: #fff; width: 0%; }
        
        .close-modal { position: absolute; top: 25px; left: 15px; font-size: 25px; color: #fff; background: rgba(0,0,0,0.5); border: none; width: 40px; height: 40px; border-radius: 50%; z-index: 100005; cursor: pointer; }
        #mute-btn { position: absolute; top: 25px; right: 15px; z-index: 100005; background: rgba(0,0,0,0.5); border: none; width: 40px; height: 40px; border-radius: 50%; color: white; display: none; font-size: 18px; }

        .media-box { height: 100%; width: 100%; display: flex; align-items: center; justify-content: center; }
        .media-box video, .media-box img { max-width: 100%; max-height: 100%; object-fit: contain; pointer-events: none; }

        .info-box { position: absolute; bottom: 25px; left: 5%; width: 90%; background: var(--yellow-box); padding: 15px; border-radius: 20px; box-sizing: border-box; color: #000; text-align: center; }

        /* Ù¾Ø§Ù¾â€ŒØ¢Ù¾ VIP */
        #business-popup { position: fixed; bottom: -150px; left: 15px; right: 15px; background: linear-gradient(135deg, #222, #000); border: 2px solid #ffd700; border-radius: 20px; padding: 12px; z-index: 10006; display: flex; align-items: center; gap: 12px; transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); cursor: pointer; }
        #business-popup.active { bottom: 100px; }
        #business-popup img { width: 55px; height: 55px; border-radius: 12px; border: 2px solid #ffd700; object-fit: cover; }
        
        .price-card { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; margin-bottom: 12px; border-right: 4px solid var(--main); text-align: right; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="marquee-container"><div class="marquee-content" id="text-marq">Ø¯Ø±Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div></div>

    <div class="top-nav">
        <div class="discount-logo"><span>%</span></div>
        <h2 style="margin:0; font-size: 18px;">ØªØ®ÙÛŒÙØ§Øª Ø§ÛŒØ°Ù‡</h2>
        <input type="text" id="searchInput" class="search-mini" placeholder="Ø¬Ø³ØªØ¬Ùˆ..." onkeyup="filterContent()">
    </div>

    <div class="story-bar" id="story-render"></div>

    <div style="padding: 10px;">
        <div class="swiper mySwiper"><div class="swiper-wrapper" id="card-render"></div></div>
    </div>

    <div class="biz-float-btn" onclick="openBizModal()">
        ğŸ”¥ Ú©Ø³Ø¨ Ú©Ø§Ø± Ùˆ Ù…Ø­ØµÙˆÙ„Øª Ø¨Ø¨Ø± Ø±ÙˆÛŒ Ú¯ÙˆØ´ÛŒ Ù‡Ù…Ø±Ø§Ù‡ Ù‡Ø²Ø§Ø±Ø§Ù† Ø§ÛŒØ°Ù‡â€ŒØ§ÛŒ ğŸš€
    </div>

    <div id="business-popup" onclick="openVipFromPop()">
        <img id="pop-biz-img" src="">
        <div style="flex:1">
            <h4 id="pop-biz-name" style="margin:0; color:#ffd700; font-size:13px;"></h4>
            <p style="margin:2px 0 0; color:#fff; font-size:10px;">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ ÙˆÛŒÚ˜Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ğŸ‘ˆ</p>
        </div>
    </div>

    <div id="storyModal">
        <div class="prog-container" id="prog-bars"></div>
        <button class="close-modal" onclick="closeMe()">âœ•</button>
        <button id="mute-btn" onclick="toggleMute()">ğŸ”‡</button>
        <div class="media-box" id="media-view" 
             onmousedown="pauseTimer()" onmouseup="resumeTimer()" 
             ontouchstart="pauseTimer()" ontouchend="resumeTimer()"></div>
        <div class="info-box">
            <h2 id="st-name" style="margin:0; font-size:18px;"></h2>
            <div id="st-desc" style="font-size:13px; margin:8px 0; font-weight:bold;"></div>
            <div id="st-btns" style="display:flex; gap:8px;"></div>
        </div>
    </div>

<div id="bizModal">
    <style>
        .biz-content { padding: 20px; text-align: center; direction: rtl; }
        .biz-header { margin-bottom: 25px; position: relative; }
        .biz-header h2 { color: #ffd700; font-size: 24px; text-shadow: 0 2px 10px rgba(255,215,0,0.3); margin-bottom: 5px; }
        .biz-header p { color: #ccc; font-size: 13px; }
        
        .coin-icon { color: #ffd700; font-size: 18px; margin-left: 5px; }
        
        .premium-card { 
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a); 
            border-radius: 20px; padding: 20px; margin-bottom: 20px; 
            border: 1px solid #333; position: relative; overflow: hidden;
            transition: transform 0.3s;
        }
        .premium-card:active { transform: scale(0.98); }

        .pkg-title { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .pkg-title strong { font-size: 18px; color: #fff; }
        .pkg-price { color: #ffd700; font-size: 16px; font-weight: bold; }

        .pkg-desc { text-align: right; color: #bbb; font-size: 12px; line-height: 1.8; margin-bottom: 15px; }
        .pkg-desc span { display: block; margin-bottom: 4px; }
        
        .wa-order-btn { 
            display: flex; align-items: center; justify-content: center; gap: 8px;
            background: #25d366; color: #fff; padding: 12px; border-radius: 12px;
            text-decoration: none; font-weight: bold; font-size: 14px;
            transition: 0.3s; border-bottom: 3px solid #128c7e;
        }
        
        .special-bundle {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            padding: 2px; border-radius: 22px; margin-top: 30px;
        }
        .bundle-inner {
            background: #000; padding: 20px; border-radius: 20px; position: relative; overflow: hidden;
        }
        .card-tag { 
            position: absolute; top: 10px; left: -30px; background: #ff3e3e; 
            color: #fff; font-size: 10px; padding: 5px 30px; transform: rotate(-45deg); 
            font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
    </style>

    <button class="close-modal" onclick="closeBizModal()">âœ•</button>
    
    <div class="biz-content">
        <div class="biz-header">
            <h2>Ù¾Ù†Ù„â€ŒØªØ®ÙÛŒÙØ§Øªâ€ŒØ§ÛŒØ°Ù‡ ğŸ’</h2>
            <p>ØªØ¨Ù„ÛŒØº Ù‡Ø¯ÙÙ…Ù†Ø¯</p>
        </div>

        <div class="premium-card" style="border-right: 4px solid #e0e0e0;">
            <div class="pkg-title">
                <strong style="color:#e0e0e0;"><span class="coin-icon" style="color:#e0e0e0;">ğŸª™</span>Ù…ØªÙ† Ø±ÙˆØ§Ù† (Marquee)</strong>
                <span class="pkg-price">Û±Ûµ,Û°Û°Û° Øª</span>
            </div>
            <div class="pkg-desc">
                <span>âœ… Ø¯Ø±Ø¬ Ø¬Ù…Ù„Ù‡ ØªØ¨Ù„ÛŒØºØ§ØªÛŒ Ø´Ù…Ø§ Ø¯Ø± Ù†ÙˆØ§Ø± Ù…ØªØ­Ø±Ú© Ø¨Ø§Ù„Ø§ÛŒ Ø³Ø§ÛŒØª</span>
                <span>âœ… Ø§ÙˆÙ„ÛŒÙ† Ú†ÛŒØ²ÛŒ Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù‡Ù†Ú¯Ø§Ù… ÙˆØ±ÙˆØ¯ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</span>
                <span>âœ… Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ø®ÙˆØ§Ù†â€ŒÙ‡Ø§ÛŒ ÙÙˆØ±ÛŒ Ùˆ Ø§Ø·Ù„Ø§Ø¹â€ŒØ±Ø³Ø§Ù†ÛŒâ€ŒÙ‡Ø§</span>
            </div>
            <a href="https://wa.me/989220730628?text=Ø³Ù„Ø§Ù…ØŒ+Ù‚ØµØ¯+Ø±Ø²Ø±Ùˆ+ØªØ¨Ù„ÛŒØº+Ø¯Ø±+Ø¨Ø®Ø´+Ù…ØªÙ†+Ø±ÙˆØ§Ù†+Ø±Ø§+Ø¯Ø§Ø±Ù…" class="wa-order-btn" style="background:#607d8b; border-bottom-color:#37474f;">
                <span>Ø³ÙØ§Ø±Ø´ Ù…ØªÙ† Ø±ÙˆØ§Ù†</span>
            </a>
        </div>

        <div class="premium-card">
            <div class="pkg-title">
                <strong><span class="coin-icon">ğŸª™</span>Ø§Ø³ØªÙˆØ±ÛŒ Ø·Ù„Ø§ÛŒÛŒ</strong>
                <span class="pkg-price">Û³Ûµ,Û°Û°Û° Øª</span>
            </div>
            <div class="pkg-desc">
                <span>âœ… Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø¨Ø®Ø´ Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ÛŒ Ø³Ø§ÛŒØª</span>
                <span>âœ… Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯Ø±Ø¬ Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù… Ùˆ Ø¯Ú©Ù…Ù‡ ØªÙ…Ø§Ø³</span>
                <span>âœ… Ø¨Ø§Ø²Ø¯Ù‡ÛŒ Ø³Ø±ÛŒØ¹ Ùˆ Ú©Ù„ÛŒÚ©â€ŒØ®ÙˆØ± Ø¨Ø³ÛŒØ§Ø± Ø¨Ø§Ù„Ø§</span>
            </div>
            <a href="https://wa.me/989220730628?text=Ø³Ù„Ø§Ù…ØŒ+Ù‚ØµØ¯+Ø±Ø²Ø±Ùˆ+Ù¾Ú©ÛŒØ¬+Ø§Ø³ØªÙˆØ±ÛŒ+Ø·Ù„Ø§ÛŒÛŒ+Ø±Ø§+Ø¯Ø§Ø±Ù…" class="wa-order-btn">
                <span>Ø³ÙØ§Ø±Ø´ Ø§Ø³ØªÙˆØ±ÛŒ Ø·Ù„Ø§ÛŒÛŒ</span>
            </a>
        </div>

        <div class="premium-card" style="border-right: 4px solid #00e5ff;">
            <div class="pkg-title">
                <strong style="color:#00e5ff;"><span class="coin-icon" style="color:#00e5ff;">ğŸ’</span>ÙˆÛŒØªØ±ÛŒÙ† Ø¯Ø§Øº</strong>
                <span class="pkg-price">ÛµÛ°,Û°Û°Û° Øª</span>
            </div>
            <div class="pkg-desc">
                <span>âœ… Ù‚Ø±Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø¯Ø± Ù„ÛŒØ³Øª Ø§ØµÙ„ÛŒ (Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÛŒÙ†)</span>
                <span>âœ… Ù…Ø§Ù†Ø¯Ú¯Ø§Ø±ÛŒ Ø¨Ø§Ù„Ø§ Ø¯Ø± Ø°Ù‡Ù† Ù…Ø®Ø§Ø·Ø¨</span>
                <span>âœ… Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø®Ø§Øµ Ùˆ Ø­Ø±Ø§Ø¬ÛŒâ€ŒÙ‡Ø§</span>
            </div>
            <a href="https://wa.me/989220730628?text=Ø³Ù„Ø§Ù…ØŒ+Ù‚ØµØ¯+Ø±Ø²Ø±Ùˆ+Ù¾Ú©ÛŒØ¬+ÙˆÛŒØªØ±ÛŒÙ†+Ø¯Ø§Øº+Ø±Ø§+Ø¯Ø§Ø±Ù…" class="wa-order-btn" style="background:#00bcd4; border-bottom-color:#00838f;">
                <span>Ø³ÙØ§Ø±Ø´ ÙˆÛŒØªØ±ÛŒÙ† Ø¯Ø§Øº</span>
            </a>
        </div>

        <div class="premium-card" style="border-right: 4px solid #ffd700;">
            <div class="pkg-title">
                <strong style="color:#ffd700;"><span class="coin-icon">ğŸ‘‘</span>Ù¾Ø§Ù¾â€ŒØ¢Ù¾ VIP</strong>
                <span class="pkg-price">Û´Ûµ,Û°Û°Û° Øª</span>
            </div>
            <div class="pkg-desc">
                <span>âœ… Ù†Ù…Ø§ÛŒØ´ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ù…Ø­Ø¶ ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ø³Ø§ÛŒØª</span>
                <span>âœ… ØªØ¶Ù…ÛŒÙ† Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªÙˆØ³Ø· Û±Û°Û°Ùª Ø¨Ø§Ø²Ø¯ÛŒØ¯Ú©Ù†Ù†Ø¯Ú¯Ø§Ù†</span>
                <span>âœ… Ø¨Ù…Ø¨ Ø§ØªÙ… ØªØ¨Ù„ÛŒØºØ§ØªÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ù†Ø¯ÛŒÙ†Ú¯ Ø³Ø±ÛŒØ¹</span>
            </div>
            <a href="https://wa.me/989220730628?text=Ø³Ù„Ø§Ù…ØŒ+Ù‚ØµØ¯+Ø±Ø²Ø±Ùˆ+Ù¾Ú©ÛŒØ¬+Ù¾Ø§Ù¾â€ŒØ¢Ù¾+VIP+Ø±Ø§+Ø¯Ø§Ø±Ù…" class="wa-order-btn" style="background:#f39c12; border-bottom-color:#a66b00;">
                <span>Ø³ÙØ§Ø±Ø´ Ù¾Ø§Ù¾â€ŒØ¢Ù¾ VIP</span>
            </a>
        </div>

        <div class="special-bundle">
            <div class="bundle-inner">
                <div class="card-tag">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ ÙˆÛŒÚ˜Ù‡</div>
                <h3 style="color:#ffd700; margin-top:0;">ğŸŒŸ Ù¾Ú©ÛŒØ¬ Ø¨Ù…Ø¨ ØªØ¨Ù„ÛŒØºØ§ØªÛŒ (Ú©Ø§Ù…Ù„)</h3>
                <div class="pkg-desc" style="text-align:center;">
                    <span>Ø´Ø§Ù…Ù„ ØªÙ…Ø§Ù… ØªØ¨Ù„ÛŒØºØ§Øª: Ø§Ø³ØªÙˆØ±ÛŒ + ÙˆÛŒØªØ±ÛŒÙ† + Ù¾Ø§Ù¾â€ŒØ¢Ù¾ + Ù…ØªÙ† Ø±ÙˆØ§Ù†</span>
                    <p style="font-size:14px; color:#fff;">ÙÙ‚Ø· <span style="text-decoration: line-through; color:#ff3e3e;">Û±Û´Ûµ,Û°Û°Û°</span> ğŸ‘ˆ <strong>Û¸Û¹,Û°Û°Û° ØªÙˆÙ…Ø§Ù†</strong></p>
                </div>
                <a href="https://wa.me/989220730628?text=Ø³Ù„Ø§Ù…ØŒ+Ù‚ØµØ¯+Ø±Ø²Ø±Ùˆ+Ù¾Ú©ÛŒØ¬+Ú©Ø§Ù…Ù„+Ø¨Ù…Ø¨+ØªØ¨Ù„ÛŒØºØ§ØªÛŒ+(Ø´Ø§Ù…Ù„+Ù‡Ù…Ù‡+Ù…ÙˆØ§Ø±Ø¯)+Ø±Ø§+Ø¯Ø§Ø±Ù…" class="wa-order-btn" style="background:#fff; color:#000; border-bottom-color:#ccc;">
                    <span>ğŸš€ ØªØ¨Ù„ÛŒØºØ§Øª Ù‡Ø²ÛŒÙ†Ù‡ Ù†ÛŒØ³Øª</span>
                </a>
            </div>
        </div>

    <script>
        let allItems = [], timer, progress = 0, isPaused = false, currentItem = null, slideIndex = 0, currentVipId = null;

        async function startup() {
            try {
                const t = `?v=${Date.now()}`;
                const [conf, stor, off] = await Promise.all([
                    fetch('config.json' + t).then(r => r.json()),
                    fetch('stories.json' + t).then(r => r.json()),
                    fetch('offers.json' + t).then(r => r.json())
                ]);
                document.getElementById('text-marq').innerText = Array.isArray(conf.marqueeText) ? conf.marqueeText.join(" âš¡ ") : conf.marqueeText;
                allItems = [...stor, ...off];
                render(stor, off);
                setTimeout(showPopup, 5000);
            } catch (e) { console.log("Error Loading Data"); }
        }

        function render(stories, offers) {
            const sDiv = document.getElementById('story-render'), cDiv = document.getElementById('card-render');
            sDiv.innerHTML = stories.map(i => `<div class="story-circle" onclick="openMe(${i.id})"><img src="${i.src || (i.slides?i.slides[0]:'')}"><br><b style="font-size:11px">${i.name}</b></div>`).join('');
            cDiv.innerHTML = offers.map(i => `<div class="swiper-slide"><div class="card-container" onclick="openMe(${i.id})"><img src="${i.src || (i.slides?i.slides[0]:'')}"><div class="card-name">${i.name}</div></div></div>`).join('');
            new Swiper(".mySwiper", { slidesPerView: 2.2, spaceBetween: 10 });
        }

        function showPopup() {
            const vips = allItems.filter(i => i.vip === true);
            if (!vips.length) return;
            const target = vips[Math.floor(Math.random() * vips.length)];
            currentVipId = target.id;
            document.getElementById('pop-biz-img').src = target.src || target.slides[0];
            document.getElementById('pop-biz-name').innerText = target.name;
            document.getElementById('business-popup').classList.add('active');
            setTimeout(() => document.getElementById('business-popup').classList.remove('active'), 10000);
        }

        function openVipFromPop() { if(currentVipId) openMe(currentVipId); document.getElementById('business-popup').classList.remove('active'); }

        function openMe(id) {
            currentItem = allItems.find(x => x.id === id);
            if(!currentItem) return;
            slideIndex = 0; document.getElementById('storyModal').style.display = 'block';
            showSlide();
        }

        function showSlide() {
            const slides = Array.isArray(currentItem.slides) ? currentItem.slides : [currentItem.src];
            const src = slides[slideIndex];
            const view = document.getElementById('media-view'), muteBtn = document.getElementById('mute-btn');
            
            document.getElementById('prog-bars').innerHTML = slides.map((_, i) => `<div class="p-bar"><div class="p-fill" id="fill-${i}" style="width:${i < slideIndex ? '100%' : '0%'}"></div></div>`).join('');

            if (src.toLowerCase().endsWith('.mp4')) {
                view.innerHTML = `<video id="st-video" autoplay playsinline muted><source src="${src}" type="video/mp4"></video>`;
                muteBtn.style.display = 'block';
                const v = document.getElementById('st-video');
                v.onloadedmetadata = () => startTimer(v.duration * 1000);
            } else {
                view.innerHTML = `<img src="${src}">`;
                muteBtn.style.display = 'none';
                startTimer(5000);
            }

            document.getElementById('st-name').innerText = currentItem.name;
            document.getElementById('st-desc').innerText = currentItem.desc;
            document.getElementById('st-btns').innerHTML = `<a href="tel:${currentItem.phone}" style="flex:1; background:#2ecc71; color:white; padding:12px; border-radius:12px; text-decoration:none; font-weight:bold; text-align:center; font-size:12px;">ğŸ“ ØªÙ…Ø§Ø³</a><a href="${currentItem.link}" target="_blank" style="flex:1; background:#ff3e3e; color:white; padding:12px; border-radius:12px; text-decoration:none; font-weight:bold; text-align:center; font-size:12px;">ğŸ“¸ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…</a>`;
        }

        function startTimer(duration) {
            progress = 0; isPaused = false; clearInterval(timer);
            timer = setInterval(() => {
                if (!isPaused) {
                    progress += (100 / (duration / 100));
                    let f = document.getElementById(`fill-${slideIndex}`);
                    if(f) f.style.width = Math.min(progress, 100) + '%';
                    if (progress >= 100) changeSlide();
                }
            }, 100);
        }

        function changeSlide() {
            const slides = Array.isArray(currentItem.slides) ? currentItem.slides : [currentItem.src];
            slideIndex++;
            if (slideIndex >= slides.length) closeMe(); else showSlide();
        }

        function toggleMute() {
            const v = document.getElementById('st-video');
            if(v) { v.muted = !v.muted; document.getElementById('mute-btn').innerText = v.muted ? 'ğŸ”‡' : 'ğŸ”Š'; }
        }

        function pauseTimer() { isPaused = true; const v = document.getElementById('st-video'); if(v) v.pause(); }
        function resumeTimer() { isPaused = false; const v = document.getElementById('st-video'); if(v) v.play(); }
        function closeMe() { const v = document.getElementById('st-video'); if(v) v.pause(); document.getElementById('storyModal').style.display = 'none'; clearInterval(timer); }
        function openBizModal() { document.getElementById('bizModal').style.display = 'block'; }
        function closeBizModal() { document.getElementById('bizModal').style.display = 'none'; }
        function filterContent() {
            const val = document.getElementById('searchInput').value.toLowerCase();
            render(allItems.filter(i => i.id < 200 && i.name.toLowerCase().includes(val)), allItems.filter(i => i.id >= 200 && i.name.toLowerCase().includes(val)));
        }

        window.onload = startup;
    </script>
</body>
    </html>
